@page "/guessanumber"

<div class="game-hero text-center py-5 mb-4">
    <h1 class="display-4 fw-bold mb-3">G√¶t et tal</h1>
    <p class="lead mb-0">Kan du g√¶tte det hemmelige tal, computeren har valgt?</p>
</div>

<div class="container game-content">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow-lg mb-5 border-0 game-card">
                <div class="card-body p-5">
                    <h2 class="h4 mb-3 text-primary fw-semibold">S√•dan spiller du:</h2>
                    <ul class="list-group list-group-flush mb-4">
                        <li class="list-group-item">Computeren v√¶lger et tilf√¶ldigt tal mellem 1 og 100.</li>
                        <li class="list-group-item">Du skal g√¶tte tallet ‚Äì og f√•r at vide, om det rigtige tal er h√∏jere eller lavere.</li>
                        <li class="list-group-item"><em>Ekstra:</em> Gem dine g√¶t i en liste og se dem til sidst!</li>
                    </ul>
                    <div class="alert alert-info mt-4">
                        <strong>Tip:</strong> Pr√∏v at g√¶tte tallet p√• f√¶rrest mulige fors√∏g ‚Äì og udfordr dine venner!
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.game-hero {
    background: linear-gradient(90deg, #1b6ec2 0%, #3a0647 100%);
    color: #fff;
    border-radius: 0 0 2rem 2rem;
    box-shadow: 0 4px 32px rgba(27,110,194,0.10);
}
.game-content {
    margin-top: -40px;
}
.game-card {
    border-radius: 1.5rem;
}
</style>

@page "/guessgame"

<h3>G√¶t et tal mellem 1 og 1000</h3>

@if (!userGameOver)
{
    <p>@message</p>
    <input type="number" @bind="userGuess" />
    <button class="btn btn-success" @onclick="CheckUserGuess">G√¶t</button>
    <p>Antal fors√∏g: @userAttempts</p>
}
else
{
    <h4>@message</h4>
    <button class="btn btn-primary" @onclick="StartComputerGuess">
        Lad computeren g√¶tte mit tal
    </button>
}

@if (computerStarted && !computerGameOver)
{
    <h3>Computeren g√¶tter dit tal!</h3>
    <p>Mit g√¶t er: <b>@computerGuess</b></p>
    <button class="btn btn-danger" @onclick="@(() => ComputerFeedback("h"))">For h√∏jt</button>
    <button class="btn btn-warning" @onclick="@(() => ComputerFeedback("l"))">For lavt</button>
    <button class="btn btn-success" @onclick="@(() => ComputerFeedback("k"))">Korrekt</button>
    <p>Antal fors√∏g: @computerAttempts</p>
}

@if (computerGameOver)
{
    <h3>@message</h3>
}

@code {
    // Brugerens spil
    private int secretNumber;
    private int userGuess;
    private int userAttempts = 0;
    private bool userGameOver = false;

    // Computeren g√¶tter
    private int min = 1;
    private int max = 1000;
    private int computerGuess;
    private int computerAttempts = 0;
    private bool computerStarted = false;
    private bool computerGameOver = false;

    private string message = "";

    protected override void OnInitialized()
    {
        // Start f√∏rste spil
        var rand = new Random();
        secretNumber = rand.Next(1, 1001);
        message = "Jeg har valgt et hemmeligt tal. G√¶t det!";
    }

    private void CheckUserGuess()
    {
        userAttempts++;
        if (userGuess < secretNumber)
        {
            message = "For lavt!";
        }
        else if (userGuess > secretNumber)
        {
            message = "For h√∏jt!";
        }
        else
        {
            message = $"Korrekt! Du brugte {userAttempts} fors√∏g.";
            userGameOver = true;
        }
    }

    private void StartComputerGuess()
    {
        computerStarted = true;
        computerAttempts = 0;
        computerGameOver = false;
        ComputerMakeGuess();
    }

    private void ComputerMakeGuess()
    {
        var rand = new Random();
        computerGuess = rand.Next(min, max + 1);
    }

    private void ComputerFeedback(string feedback)
    {
        computerAttempts++;
        if (feedback == "h")
        {
            max = computerGuess - 1;
            ComputerMakeGuess();
        }
        else if (feedback == "l")
        {
            min = computerGuess + 1;
            ComputerMakeGuess();
        }
        else if (feedback == "k")
        {
            message = $"Jeg g√¶ttede dit tal {computerGuess} p√• {computerAttempts} fors√∏g! üéâ";
            computerGameOver = true;
        }
    }
}