@page "/hjemmet"
@using System.Threading


<div class="hjemmet-hero text-center py-5 mb-4">
    <h1 class="display-3 fw-bold mb-3">Hjemmet</h1>
    <p class="lead mb-0">Små tidsfordrivsspil til hjemmekontoret</p>
</div>

@if (secretNumber != 0)
{
    <p> @secretNumber </p>
}



@code{

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await Task.Delay(500); // Optional delay to ensure the component is fully rendered
            Start();
        }
    }

@page "/guessgame"

<h3>Gæt et tal mellem 1 og 1000</h3>

@if (!userGameOver)
{
<p>@message</p>
<input type="number" @bind="userGuess" />
<button @onclick="CheckUserGuess">Gæt</button>
<p>Antal forsøg: @userAttempts</p>
}
else
{
<h4>@message</h4>
<button @onclick="StartComputerGuess">Lad computeren gætte mit tal</button>
}

@if (computerStarted && !computerGameOver)
{
<h3>Computeren gætter dit tal!</h3>
<p>Mit gæt er: <b>@computerGuess</b></p>
<button @onclick="() => ComputerFeedback('h')">For højt</button>
<button @onclick="() => ComputerFeedback('l')">For lavt</button>
<button @onclick="() => ComputerFeedback('k')">Korrekt</button>
<p>Antal forsøg: @computerAttempts</p>
}

@if (computerGameOver)
{
<h3>@message</h3>
}

@code {
    // Brugerens spil
    private int secretNumber;
    private int userGuess;
    private int userAttempts = 0;
    private bool userGameOver = false;

    // Computeren gætter
    private int min = 1;
    private int max = 1000;
    private int computerGuess;
    private int computerAttempts = 0;
    private bool computerStarted = false;
    private bool computerGameOver = false;

    private string message = "";

    protected override void OnInitialized()
    {
        // Start første spil
        var rand = new Random();
        secretNumber = rand.Next(1, 1001);
        message = "Jeg har valgt et hemmeligt tal. Gæt det!";
    }

    private void CheckUserGuess()
    {
        userAttempts++;
        if (userGuess < secretNumber)
        {
            message = "For lavt!";
        }
        else if (userGuess > secretNumber)
        {
            message = "For højt!";
        }
        else
        {
            message = $"Korrekt! Du brugte {userAttempts} forsøg.";
            userGameOver = true;
        }
    }

    private void StartComputerGuess()
    {
        computerStarted = true;
        computerAttempts = 0;
        computerGameOver = false;
        ComputerMakeGuess();
    }

    private void ComputerMakeGuess()
    {
        var rand = new Random();
        computerGuess = rand.Next(min, max + 1);
    }

    private void ComputerFeedback(string feedback)
    {
        computerAttempts++;
        if (feedback == "h")
        {
            max = computerGuess - 1;
            ComputerMakeGuess();
        }
        else if (feedback == "l")
        {
            min = computerGuess + 1;
            ComputerMakeGuess();
        }
        else if (feedback == "k")
        {
            message = $"Jeg gættede dit tal {computerGuess} på {computerAttempts} forsøg! 🎉";
            computerGameOver = true;
        }
    }
    }
}

    }
}
    
